<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Working Menu Mechanic - Landscape A4</title>
    <style>
        @page { size: A4 landscape; margin: 5mm; }
        body { font-family: Arial, sans-serif; background-color: #f0f0f0; margin: 0; padding: 0; }
        .paper { 
            background: white; width: 287mm; height: 200mm; margin: auto; 
            padding: 10mm; border: 1px solid #000; box-sizing: border-box;
            display: flex; flex-direction: column;
        }
        .header-top { display: flex; justify-content: space-between; align-items: flex-end; }
        .title { text-align: center; font-weight: bold; font-size: 18px; flex-grow: 1; text-decoration: underline; }
        .input-line { border: none; border-bottom: 1px solid black; outline: none; width: 180px; text-align: center; font-weight: bold; }
        .main-container { display: flex; border: 1px solid black; flex-grow: 1; }
        .left-col { width: 65%; border-right: 1px solid black; }
        .right-col { width: 35%; }
        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        th, td { border: 1px solid black; padding: 4px; font-size: 11px; vertical-align: middle; }
        th { background-color: #e0e0e0; }
        .editable { width: 95%; border: none; text-align: center; font-family: 'Courier New', monospace; font-size: 12px; font-weight: bold; }
        .note-section { border: 1px solid black; border-top: none; padding: 10px; height: 40mm; }
        .note-input { width: 100%; height: 30mm; border: none; resize: none; font-weight: bold; font-family: 'Courier New', monospace; }
        .no-print { text-align: center; padding: 20px; }
        .btn { padding: 10px 20px; font-weight: bold; cursor: pointer; border: none; border-radius: 4px; color: white; margin: 5px; }
        .btn-pdf { background: #2c3e50; }
        .btn-wa { background: #25D366; }
        @media print { .no-print { display: none; } .paper { border: none; margin: 0; } }
    </style>
</head>
<body>

<div class="paper">
    <div class="header-top">
        <div>NAMA : <input type="text" id="nama" class="input-line"></div>
        <div class="title">DAILY WORKING MENU MECHANIC</div>
        <div style="font-weight: bold;">Daily Check list</div>
    </div>
    <div style="text-align: center; margin: 10px 0; font-weight: bold;">
        DATE : <input type="text" id="autoDate" class="input-line">
    </div>

    <div class="main-container">
        <div class="left-col">
            <table>
                <thead><tr><th>Freq</th><th>CT</th><th>Working Menu</th><th>Actual CT</th></tr></thead>
                <tbody>
                    <script>
                        const menus = ["Briefing awal shift", "Standby & perbaikan mesin", "Update persiapan QCO", "Pengecekan & update PM", "5S area line", "Laporan setengah hari", "Response perbaikan line", "Laporan buku harian", "Mechanic DOM meeting", "Training"];
                        const cts = [10, 90, 60, 60, 30, 15, 90, 30, 30, 60];
                        menus.forEach((m, i) => {
                            document.write(`<tr>${i==0?'<td rowspan="10" align="center">Daily</td>':''}<td>${cts[i]}</td><td>${m}</td><td><input type="text" class="editable act-ct"></td></tr>`);
                        });
                    </script>
                    <tr><td colspan="2"><b>MH used</b></td><td colspan="2"><b><input type="text" id="mhUsed" class="editable" value="475"></b></td></tr>
                    <tr><td colspan="2"><b>MH available</b></td><td colspan="2"><b><input type="text" id="mhAvail" class="editable" value="480"></b></td></tr>
                    <tr><td colspan="2"><b>Productivity</b></td><td colspan="2"><b><input type="text" id="prod" class="editable" value="99%"></b></td></tr>
                </tbody>
            </table>
        </div>
        <div class="right-col">
            <table>
                <thead><tr><th width="15%">#</th><th>Item</th><th width="15%">Y</th><th width="15%">N</th></tr></thead>
                <tbody>
                    <script>
                        const items = ["PM list update?", "Kabel & selang rapi?", "Kolong mesin bersih?", "Tiang benang kencang?", "Mesin line bersih?", "Kebocoran angin?", "Kaki meja kokoh?"];
                        items.forEach((item, i) => {
                            document.write(`<tr><td align="center">${i+1}</td><td>${item}</td><td align="center"><input type="checkbox"></td><td align="center"><input type="checkbox"></td></tr>`);
                        });
                    </script>
                </tbody>
            </table>
            <table style="border-top: none;">
                <thead><tr><th colspan="3">QCO</th></tr><tr><th>Line</th><th>Style</th><th>Date</th></tr></thead>
                <tbody>
                    <script>for(let i=0; i<5; i++) document.write('<tr><td><input class="editable"></td><td><input class="editable"></td><td><input class="editable"></td></tr>');</script>
                </tbody>
            </table>
        </div>
    </div>
    <div class="note-section">
        <b>NOTE :</b><br>
        <textarea id="note" class="note-input" placeholder="Tulis catatan perbaikan di sini..."></textarea>
    </div>
</div>

<div class="no-print">
    <button onclick="window.print()" class="btn btn-pdf">SIMPAN PDF / CETAK</button>
    <button onclick="sendWA()" class="btn btn-wa">KIRIM RINGKASAN WA</button>
</div>

<script>
    window.onload = () => {
        const t = new Date();
        document.getElementById('autoDate').value = `${String(t.getDate()).padStart(2,'0')}/${String(t.getMonth()+1).padStart(2,'0')}/${t.getFullYear()}`;
    };

    function sendWA() {
        const nama = document.getElementById('nama').value || "-";
        const prod = document.getElementById('prod').value;
        const note = document.getElementById('note').value || "-";
        let text = `*LAPORAN MEKANIK*%0A*Nama:* ${nama}%0A*Prod:* ${prod}%0A*Note:* ${note}%0A%0A_Silakan lampirkan file PDF hasil cetakan di bawah ini._`;
        window.open(`https://wa.me/?text=${text}`, '_blank');
    }
</script>
</body>
</html>
